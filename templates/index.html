<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>KRISHNA X FEAR ‚Ä¢ KeyAuth Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    :root{
        --bg1:#25345f; --bg2:#0b0f1d; --card:#0a0f1c;
        --accent:#4cc9ff; --accent2:#9560ff; --muted:#7d8fb3;
        --glass-border:rgba(120,180,255,.35);
    }
    html,body{height:100%;margin:0;font-family:'Inter',sans-serif;background:radial-gradient(circle at top,var(--bg1) 0%,var(--bg2) 60%,#03040b 100%);color:#e9f5ff}
    
    /* üéØ LARGER PANEL */
    .app-wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;gap:22px;position:relative}
    
    /* global title */
    .global-title-bar{position:fixed;top:16px;left:50%;transform:translateX(-50%);z-index:80;pointer-events:none}
    .global-title{pointer-events:auto;font-family:'Orbitron',sans-serif;text-transform:uppercase;letter-spacing:.25em;font-size:1.2rem;padding:12px 28px;border-radius:999px;background:radial-gradient(circle at top,rgba(76,201,255,0.18),rgba(5,10,25,0.9));border:1px solid rgba(122,187,255,0.45);color:#e9f5ff;text-shadow:0 0 12px rgba(76,201,255,0.9);box-shadow:0 0 30px rgba(0,0,0,.9)}

    /* üéØ LARGER GLASS CARD */
    .glass-card{width:95%;max-width:1400px !important;background:linear-gradient(180deg,rgba(6,10,25,0.95),rgba(2,6,23,0.95));border-radius:20px;padding:35px;border:1px solid var(--glass-border);box-shadow:0 30px 70px rgba(0,0,0,.9);backdrop-filter:blur(12px)}
    
    /* login */
    .login-card{display:flex;flex-direction:column;gap:15px;width:450px;max-width:calc(100% - 40px)}
    .login-brand{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .login-title{font-family:'Orbitron',sans-serif;text-transform:uppercase;letter-spacing:.2em;font-size:1.1rem}
    .login-title .krishna{color:var(--accent)} .login-title .fear{color:#ff6bcb} .login-title .auth{color:#d9e7ff}
    .login-sub{font-size:.85rem;color:var(--muted)}
    .pill{padding:6px 14px;border-radius:999px;font-size:.8rem;border:1px solid rgba(148,163,255,.6);color:#c7d2ff;background:rgba(15,23,42,0.9)}
    .field-label{font-size:.85rem;color:#9eb3d8;margin-top:12px;font-weight:500}
    .login-input{width:100%;padding:16px;border-radius:14px;border:1px solid rgba(124,152,230,.7);background:rgba(2,6,23,.92);color:#e9f5ff;font-size:1.05rem;outline:none;transition:all .3s}
    .login-input:focus{border-color:var(--accent);box-shadow:0 0 12px rgba(76,201,255,.4)}
    .login-btn{width:100%;padding:16px;border-radius:999px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#020617;font-weight:700;font-size:1.1rem;cursor:pointer;margin-top:12px;transition:all .3s}
    .login-btn:hover{transform:translateY(-3px);box-shadow:0 15px 35px rgba(76,201,255,.4)}
    .login-footer{display:flex;justify-content:space-between;font-size:.8rem;color:#8993a8;margin-top:12px}
    .error{color:#ff6b81;font-size:.95rem;padding:10px;border-radius:8px;background:rgba(255,107,129,.1);border:1px solid rgba(255,107,129,.2)}

    /* üéØ LARGER PANEL STYLES */
    .auth-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:20px;border-bottom:1px solid rgba(120,180,255,.15)}
    .brand-title{font-family:'Orbitron',sans-serif;letter-spacing:.25em;text-transform:uppercase;font-size:1.4rem;color:#9fd5ff}
    .brand-sub{font-size:.9rem;color:var(--muted);margin-top:4px}
    .status-pill{padding:8px 16px;border-radius:999px;font-size:.85rem;text-transform:uppercase;border:1px solid rgba(77,255,136,.7);color:#4dff88;background:rgba(5,26,18,.85);box-shadow:0 4px 15px rgba(77,255,136,.2)}
    
    h1{font-size:2.2rem;margin:25px 0 12px;color:#e9f5ff;font-weight:700}
    h2{font-size:1.5rem;margin:20px 0 15px}
    .subtitle{color:var(--muted);font-size:1.1rem;margin-bottom:20px;font-weight:400}
    
    /* üéØ BIGGER FORM */
    .form-group{display:grid;grid-template-columns:2fr 1fr auto;gap:20px;align-items:end;margin:25px 0}
    .form-group input[type=text], .form-group input[type=number]{padding:18px;border-radius:14px;border:1px solid rgba(116,154,230,.5);background:rgba(3,7,20,.9);color:#e9f5ff;font-size:1.1rem;flex:1}
    .form-group input:focus{border-color:var(--accent);box-shadow:0 0 20px rgba(76,201,255,.3)}
    .hwid-toggle{font-size:1rem;color:var(--muted);display:inline-flex;align-items:center;gap:12px;padding:15px;background:rgba(15,23,42,.6);border-radius:14px;border:1px solid rgba(120,180,255,.2);cursor:pointer}
    
    .gen-btn{padding:18px 30px;border-radius:16px;border:none;background:linear-gradient(90deg,#4cc9ff,#9560ff);color:#020617;font-weight:700;font-size:1.1rem;cursor:pointer;display:inline-flex;align-items:center;gap:12px;margin-top:20px;transition:all .3s;box-shadow:0 10px 30px rgba(76,201,255,.3)}
    .gen-btn:hover{transform:translateY(-4px);box-shadow:0 20px 40px rgba(76,201,255,.5)}
    
    .key-result{margin-top:25px;padding:25px;border-radius:18px;background:rgba(5,8,18,.7);border:1px solid rgba(120,180,255,.25)}
    .key-display{display:flex;align-items:center;gap:20px}
    #generatedKey{font-family:'Orbitron',monospace;font-weight:900;font-size:1.4rem;letter-spacing:2px;color:var(--accent);text-shadow:0 0 15px rgba(76,201,255,.5)}
    .copy-btn{padding:14px 18px;border-radius:14px;border:1px solid rgba(116,154,230,.6);background:rgba(4,12,30,.9);color:var(--accent);cursor:pointer;font-size:1.1rem;transition:all .3s}
    .copy-btn:hover{background:var(--accent);color:#020617;transform:scale(1.05)}
    .key-info{margin-top:15px;color:var(--muted);font-size:1rem;font-weight:500}
    
    /* üéØ BIGGER TABLE */
    .table-card{padding:0;margin-top:35px}
    .table-container{max-height:500px;overflow:auto;border-radius:20px;border:1px solid rgba(120,180,255,.15);box-shadow:0 10px 40px rgba(0,0,0,.5)}
    table{width:100%;border-collapse:collapse;color:#e9f5ff;font-size:1rem}
    th,td{padding:18px 15px;border-bottom:1px solid rgba(255,255,255,.03);text-align:left}
    th{background:linear-gradient(90deg,rgba(76,201,255,.12),rgba(149,96,255,.08));font-weight:600;font-size:1rem;color:var(--accent);letter-spacing:.05em}
    td{font-weight:500}
    
    .status-badge{padding:6px 12px;border-radius:8px;font-size:.85rem;font-weight:600}
    .status-active{background:rgba(77,255,136,.25);color:#4dff88;border:1px solid rgba(77,255,136,.5)}
    .status-expired{background:rgba(255,107,107,.25);color:#ff6b6b;border:1px solid rgba(255,107,107,.4)}
    .status-banned{background:rgba(255,184,107,.25);color:#ffb86b;border:1px solid rgba(255,184,107,.4)}
    
    .loading{text-align:center;color:var(--muted);padding:40px;font-size:1.1rem}
    .del-btn{background:none;border:none;color:#ff7b7b;cursor:pointer;font-size:1.2rem;padding:10px;transition:all .3s}
    .del-btn:hover{color:#ff4444;transform:scale(1.2)}
    .reset-btn{background:none;border:none;color:#ffaa00;cursor:pointer;font-size:1.2rem;padding:10px;margin-left:10px;transition:all .3s}
    .reset-btn:hover{color:#ffcc00;transform:scale(1.2)}
    
    .footer-terms{position:fixed;bottom:15px;left:50%;transform:translateX(-50%);font-size:.85rem;color:var(--muted);font-weight:500}
    
    /* hide panel initially */
    #panelWrap{display:none}
    .hidden{display:none}
    
    /* status message */
    .status{position:relative;margin-top:15px;padding:15px;border-radius:12px;font-size:1rem;border-left:4px solid var(--accent)}
    .status.success{background:rgba(17,68,25,.3);border-color:#4dff88;color:#bff7d0}
    .status.error{background:rgba(80,10,10,.4);border-color:#ff6b6b;color:#ffd6d6}
    
    @media (min-width:1200px){.app-wrap{padding:40px}}
    @media (max-width:768px){.glass-card{padding:25px}.form-group{grid-template-columns:1fr !important;gap:15px}}
</style>
</head>
<body>

<div class="global-title-bar"><div class="global-title">FEAR X CORPORATION PANEL</div></div>

<div class="app-wrap">

    <!-- LOGIN CARD -->
    <div class="glass-card login-card" id="loginWrap">
        <div class="login-brand">
            <div>
                <div class="login-title"><span class="krishna">KRISHNA</span> <span class="fear">X FEAR</span> <span class="auth">AUTH</span></div>
                <div class="login-sub">Owner panel login</div>
            </div>
            <div class="pill">KEYAUTH PANEL</div>
        </div>

        <div id="loginError" class="error hidden"></div>

        <div class="field-label">Username</div>
        <input id="loginUser" class="login-input" type="text" placeholder="Enter panel username">

        <div class="field-label">Password</div>
        <input id="loginPass" class="login-input" type="password" placeholder="Enter panel password">

        <button id="loginBtn" class="login-btn">üöÄ ENTER DASHBOARD</button>

        <div class="login-footer"><span>¬© 2025 KRISHNA X FEAR</span><a href="/">Back</a></div>
    </div>

    <!-- üéØ LARGER PANEL -->
    <div id="panelWrap" class="glass-card" aria-hidden="true">
        <div class="auth-header">
            <div>
                <div class="brand-title">KRISHNA X FEAR AUTHENTICATION</div>
                <div class="brand-sub">Secure license panel ‚Ä¢ KeyAuth</div>
            </div>
            <div style="display:flex;align-items:center;gap:15px">
                <a href="https://discord.gg/wUZYMSvUKZ" target="_blank" style="display:inline-flex;align-items:center;gap:8px;text-decoration:none;color:#9fd5ff;font-size:1rem;font-weight:500">
                    <i class="fab fa-discord" style="font-size:1.3rem"></i><span>Discord</span>
                </a>
                <div class="status-pill"><i class="fas fa-shield-halved"></i> STATUS ONLINE</div>
            </div>
        </div>

        <h1><i class="fas fa-key" style="color:var(--accent);margin-right:15px"></i> License Console</h1>
        <p class="subtitle">Generate & manage your access keys with real-time monitoring</p>

        <div class="form-group">
            <input id="username" type="text" placeholder="üë§ Username" maxlength="20">
            <input id="days" type="number" min="1" max="365" value="7" placeholder="üìÖ Days">
            <label class="hwid-toggle"><input id="hwidLock" type="checkbox"> <i class="fas fa-lock" style="color:var(--accent)"></i> HWID Lock</label>
        </div>

        <div style="display:flex;gap:20px;align-items:center;flex-wrap:wrap">
            <button id="genBtn" class="gen-btn"><i class="fas fa-magic" style="font-size:1.2rem"></i> <span>Generate Key</span></button>
            <button id="logoutBtn" class="gen-btn" style="background:linear-gradient(90deg,#ff6b6b,#ffb86b);padding:18px 25px">üö™ Logout</button>
        </div>

        <div id="keyResult" class="key-result hidden">
            <div class="key-display">
                <span id="generatedKey"></span>
                <button id="copyBtn" class="copy-btn"><i class="fas fa-copy"></i> Copy Key</button>
            </div>
            <div class="key-info">
                <span id="keyUsername"></span> | 
                <span id="keyDays"></span> | 
                <span id="keyHWID"></span>
            </div>
        </div>

        <div class="table-card">
            <h2><i class="fas fa-list" style="color:var(--accent);margin-right:10px"></i> Active Keys <span id="totalKeys" style="font-size:1rem;color:var(--muted)">(0)</span></h2>
            <div class="table-container">
                <table id="keysTable">
                    <thead><tr><th>Key</th><th>User</th><th>Days Left</th><th>HWID</th><th>IP</th><th>Uses</th><th>Status</th><th>Actions</th></tr></thead>
                    <tbody><tr><td colspan="8" class="loading">üîÑ Loading keys...</td></tr></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="footer-terms">¬© 2025 KRISHNA X FEAR ‚Ä¢ All Rights Reserved</div>

<script>
/* ========== CONFIG ========== */
const BASE_URL = "https://mykeyauth.onrender.com/";
const API_HEADERS = {
    "Content-Type": "application/json",
    "X-Owner-Id": "jkl4drh6",
    "X-Secret": "ioyskcnwtdnzoexis6283niisns",
    "X-Api-Key": "panel_789"
};
/* ============================ */

const VALID_USER = "778899";
const VALID_PASS = "998877";

function setAuth(val){ sessionStorage.setItem("kx_auth", val ? "1":"0"); }
function isAuth(){ return sessionStorage.getItem("kx_auth")==="1"; }
function clearAuth(){ sessionStorage.removeItem("kx_auth"); }

const loginWrap = document.getElementById("loginWrap");
const panelWrap = document.getElementById("panelWrap");
const loginUser = document.getElementById("loginUser");
const loginPass = document.getElementById("loginPass");
const loginBtn = document.getElementById("loginBtn");
const loginError = document.getElementById("loginError");
const logoutBtn = document.getElementById("logoutBtn");
const genBtn = document.getElementById("genBtn");
const usernameInput = document.getElementById("username");
const daysInput = document.getElementById("days");
const hwidLockInput = document.getElementById("hwidLock");
const keyResult = document.getElementById("keyResult");
const generatedKey = document.getElementById("generatedKey");
const keyUsername = document.getElementById("keyUsername");
const keyDays = document.getElementById("keyDays");
const keyHWID = document.getElementById("keyHWID");
const copyBtn = document.getElementById("copyBtn");
const keysTableBody = document.querySelector("#keysTable tbody");
const totalKeys = document.getElementById("totalKeys");

let keysData = {};

/* ===== Protection ===== */
document.addEventListener("contextmenu", e => e.preventDefault());
document.onkeydown = function(e){
    if(e.keyCode===123 || (e.ctrlKey && e.shiftKey && (e.keyCode===73 || e.keyCode===74 || e.keyCode===67)) || (e.ctrlKey && e.keyCode===85)) return false;
};

/* ===== View control ===== */
function showPanel(){ loginWrap.style.display = "none"; panelWrap.style.display = "block"; panelWrap.removeAttribute("aria-hidden"); setAuth(true); loadKeys(); }
function showLogin(){ loginWrap.style.display = "block"; panelWrap.style.display = "none"; panelWrap.setAttribute("aria-hidden","true"); clearAuth(); }

if(isAuth()) showPanel(); else showLogin();

/* ===== Login ===== */
loginBtn.addEventListener("click", (e)=>{
    e.preventDefault();
    loginError.classList.add("hidden");
    const user = String(loginUser.value || "").trim();
    const pass = String(loginPass.value || "").trim();
    if(!user || !pass){ loginError.textContent="Enter username & password"; loginError.classList.remove("hidden"); return; }
    if(user === VALID_USER && pass === VALID_PASS){
        loginUser.value = ""; loginPass.value = "";
        showPanel();
    } else {
        loginError.textContent = "‚ùå Invalid credentials"; loginError.classList.remove("hidden");
    }
});

logoutBtn.addEventListener("click", ()=> showLogin());

/* ===== Status ===== */
function showStatus(msg, type="success"){
    const s = document.createElement("div");
    s.className = `status ${type}`;
    s.textContent = msg;
    panelWrap.appendChild(s);
    setTimeout(()=>s.remove(), 4000);
}

async function api_call(endpoint, options = {}){
    if(!isAuth()) throw new Error("Not authenticated");
    const resp = await fetch(BASE_URL + endpoint, { 
        ...options, 
        headers: { ...API_HEADERS, ...options.headers }
    });
    return resp.json();
}

/* ===== Generate Key ===== */
genBtn.addEventListener("click", async ()=>{
    if(!isAuth()) return showStatus("Please login first", "error");
    const name = (usernameInput.value || "User").trim();
    const days = parseInt(daysInput.value) || 7;
    const hwid = !!hwidLockInput.checked;
    
    genBtn.disabled = true;
    genBtn.innerHTML = '<i class="fas fa-spinner fa-spin" style="font-size:1.2rem"></i> <span>Generating...</span>';
    
    try{
        const data = await api_call("/generate", {
            method: "POST",
            body: JSON.stringify({ username: name, days, hwid_lock: hwid })
        });
        if(data.success && data.key){
            generatedKey.textContent = data.key;
            keyUsername.textContent = data.data.username;
            keyDays.textContent = `${data.data.days} days`;
            keyHWID.textContent = data.data.hwid ? data.data.hwid.slice(0,12)+"..." : "None";
            keyResult.classList.remove("hidden");
            showStatus(`‚úÖ Key generated for ${data.data.days} days!`, "success");
            loadKeys();
        } else {
            showStatus("‚ùå " + (data.message || "Generation failed"), "error");
        }
    }catch(err){
        showStatus("‚ùå Network error - Check connection", "error");
    } finally {
        genBtn.disabled = false;
        genBtn.innerHTML = '<i class="fas fa-magic" style="font-size:1.2rem"></i> <span>Generate Key</span>';
    }
});

copyBtn.addEventListener("click", async ()=>{
    const k = generatedKey.textContent;
    if(k) {
        await navigator.clipboard.writeText(k);
        showStatus("‚úÖ Key copied to clipboard!", "success");
    }
});

/* ===== Keys Table ===== */
async function loadKeys(){
    if(!isAuth()) return;
    try{
        const json = await api_call("/keys");
        if(json.success){
            keysData = json.keys || {};
            totalKeys.textContent = `(${json.total || 0})`;
            updateTable();
        }
    }catch(err){
        keysTableBody.innerHTML = '<tr><td colspan="8" class="loading">‚ùå Error loading keys</td></tr>';
    }
}

function updateTable(){
    keysTableBody.innerHTML = "";
    if(Object.keys(keysData).length === 0){
        keysTableBody.innerHTML = '<tr><td colspan="8" class="loading">üì≠ No keys found</td></tr>';
        return;
    }
    
    Object.entries(keysData).forEach(([key, data])=>{
        const tr = document.createElement("tr");
        const statusClass = data.banned ? "status-banned" : (data.days_left === 0 ? "status-expired" : "status-active");
        const hwid = data.hwid || data.last_hwid || "None";
        const ip = data.last_ip || "None";
        
        tr.innerHTML = `
            <td style="font-family:'Orbitron',monospace;font-weight:700">${key.slice(0,12)}...</td>
            <td>${data.username || '-'}</td>
            <td style="font-weight:700;color:var(--accent)">${data.days_left || 0}</td>
            <td title="${hwid}">${hwid.slice ? hwid.slice(0,12)+"..." : hwid}</td>
            <td title="${ip}">${ip.slice ? ip.slice(0,16)+"..." : ip}</td>
            <td>${data.uses || 0}/${data.max_uses || '‚àû'}</td>
            <td><span class="status-badge ${statusClass}">${data.banned ? 'BANNED' : (data.days_left === 0 ? 'EXPIRED' : 'ACTIVE')}</span></td>
            <td>
                <button class="del-btn" title="Delete"><i class="fas fa-trash"></i></button>
                <button class="reset-btn" title="Reset HWID"><i class="fas fa-unlock"></i></button>
            </td>
        `;
        
        // Delete
        tr.querySelector(".del-btn").addEventListener("click", async ()=>{
            if(confirm("üóëÔ∏è Delete this key permanently?")) {
                try{
                    const resp = await api_call("/delete", { method: "POST", body: JSON.stringify({key}) });
                    if(resp.success) {
                        showStatus("üóëÔ∏è Key deleted successfully", "success");
                        loadKeys();
                    }
                }catch(e){
                    showStatus("‚ùå Delete failed", "error");
                }
            }
        });
        
        // Reset HWID
        tr.querySelector(".reset-btn").addEventListener("click", async ()=>{
            try{
                const resp = await api_call("/reset_hwid", { method: "POST", body: JSON.stringify({key}) });
                if(resp.success) {
                    showStatus("üîì HWID reset successfully", "success");
                    loadKeys();
                }
            }catch(e){
                showStatus("‚ùå Reset failed", "error");
            }
        });
        
        keysTableBody.appendChild(tr);
    });
}

/* Auto refresh every 5s */
setInterval(()=> isAuth() && loadKeys(), 5000);

loadKeys();
</script>
</body>
</html>
